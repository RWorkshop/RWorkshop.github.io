CS1B Paper G {data-navmenu="R for Actuarial Statistics"}
==============================================================

Column {.tabset}
--------------------------------

### Question 1

<h4>Exercise 1</h4>

A researcher records the levels of caffeine present in their bloodstream at various time 
intervals after drinking a cup of coffee. 
T: Time elapsed 
(30-minute 
intervals) 
1 2 3 4 5 6 7 8 9 10 
C: Caffeine in 
blood 
(milligrams) 
52.2 39.3 28.3 19.03 13.96 11.46 8.78 6.55 5.43 5.03 
 
You can enter the values, for T (time) and C (caffeine), into R using: 
time = c(1,2,3,4,5,6,7,8,9,10) 
caffeine = c(52.2,39.3,28.3,19.03,13.96,11.46,8.78,6.55,5.43,5.03)

#### Exercises

(i) Plot a scatterplot of the data. 
(ii) Comment on the relationship between C and T based on the plot in part (i). 
(iii) Justify why a logarithmic transformation of C is appropriate. 
(iv) Perform the transformation suggested in part (iii). 
(v) (a) Plot a scatterplot of the transformed data. 
(b) Calculate the Pearson correlation coefficient for the transformed data. 
(c) Comment on the scatterplot and Pearson correlation coefficient 
produced in parts (v)(a) and (v)(b). 

### Question 2

<h4>Exercise 2</h4>
2 An analysis was carried out to investigate the fairness of two exam markers. They 
both marked the same 150 exam papers, with 10 questions and total possible marks of 
100 for each exam paper. The data were collected and arranged into 10 equally spaced 
groups, with marks rounded to the nearest whole number. 
Below are the frequencies of the marks given by each of the exam markers: 
Exam marks 0‚Äì10 11‚Äì20 21‚Äì30 31‚Äì40 41‚Äì50 51‚Äì60 61‚Äì70 71‚Äì80 81‚Äì90 91‚Äì100
Marker 1 1 8 14 22 33 34 21 9 6 2 
Marker 2 0 4 16 25 27 42 23 4 9 0 
 
You can enter the exam marks for Marker 1 and Marker 2 into R using: 
<pre><code>
marks_1 = c(1,8,14,22,33,34,21,9,6,2) 
marks_2 = c(0,4,16,25,27,42,23,4,9,0)  
</code></pre>
(i) (a) Plot two graphs, one for each marker, for the distribution of the exam 
marks given by the two markers. 
[Hint: You may find the R command barplot() useful.] 
(b) Comment on the graphs produced in part (i)(a). 


One of the marked exam papers is selected at random and the scores given by each of 
the markers are analysed further by question. Below are the scores given by each of 
the exam markers for this selected exam paper for each of the 10 questions: 
<pre><code>
Question 1 2 3 4 5 6 7 8 9 10 
Marker 1 4 1 5 1 4 6 4 5 3 6 
Marker 2 3 2 4 0 3 4 2 3 3 6 
</code></pre>
You can enter the scores for Marker 1 and Marker 2 into R using: 

<pre><code>
marker_1 = c(4,1,5,1,4,6,4,5,3,6) 
marker_2 = c(3,2,4,0,3,4,2,3,3,6) 
</code></pre>

#### Exercises

2. Perform a suitable test to determine whether the difference in the mean scores 
of the two markers is zero or not, at the 5% confidence level, taking into 
account that the two markers have marked the same exam paper. [5] 
3. Perform the test specified in part (ii), ignoring that the two markers have 
marked the same exam paper. 
(iv) Comment on your conclusions from parts (ii) and (iii). 
(v) Comment on the issues arising when analysing paired data as independent 
samples, and independent samples as though they were paired. 


### Question 3

<h4>Exercise 3</h4>
3 A study was carried out to estimate the proportion, ùëù, of workers that commute by 
train to work. A total of n ‡µå 200 workers were sampled at random and were asked the 
question: ‚ÄòDo you take the train to work?‚Äô The workers‚Äô answers were recorded as a 
binary outcome, yi, for worker i, with 1 for yes and 0 for no. The data are available in 
the file BinaryTrain.RData.
Two commuters, Alice and Norman, were interested in the study and proposed 
different prior distributions for the proportion p. 
Alice assumed a discrete prior distribution g(p) given in the following table: 
p 0.1 0.2 0.3 0.4 0.5 
g(p) 0.5 0.2 0.2 0.05 0.05 
Norman chose to use a beta prior distribution for p, with parameters 3 and 12. 
(i) (a) Calculate the mean and the standard deviation for Alice‚Äôs prior
distribution. 
(b) Generate 10,000 random values from Norman‚Äôs prior distribution. 
(c) Calculate the mean and standard deviation of the values generated in
part (i)(b). 
(d) Comment on whether or not Alice and Norman have similar prior 
beliefs for p. 
Norman‚Äôs beta prior distribution for p is adopted for the remainder of the question. 
The likelihood of the model in the study is given by: 
L·à∫p·àª ‚àù p‚àë yi ·à∫1 ‚Äì p·àªn ‚Äì ‚àë yi . 
The posterior density of p is given by: 
f(p|y) ‚àù p2 + ‚àë yi·à∫1 ‚Äì p·àª11 + n ‚Äì ‚àëyi ,
where ‚àë yi is the total sum of all the binary data. 
(ii) Plot the shape of the posterior density of p without identifying it. 
(iii) Plot the density of Norman‚Äôs prior distribution by setting ylim = c(0,14). 
 
The posterior distribution of p is beta with parameters 3 + ‚àë yi and 12 + n ‚Äì ‚àë yi
. 
(iv) (a) Plot the posterior density of p by adding it to the plot in part (iii). 
(b) Compare the two densities using your answer in part (iv)(a). 
(c) Comment on the extent to which the posterior distribution is affected 
by the prior distribution. 

(v) Determine a 90% interval estimate for p based on its posterior distribution. 
 
(vi) Determine the exact posterior probability that p exceeds 0.25. 
(vii) (a) Generate 10,000 samples from the posterior distribution of p. 
(b) Calculate the proportion of sampled values of p that exceed 0.25. 
(c) Compare your answer in part (vii)(b) with your answer in part (vi). 

### Question 4

<h4>Exercise 4</h4>
4 A statistician wants to model the number of passengers boarding a bus from a bus 
stop close to a student residential area. They can think of three explanatory variables: 
which route it is (at 8 am or 9 am), if it is during the semester or not, and the 
temperature (temp) in degrees Celsius. The statistician has data for 20 days, given in 
the file named CS1passenger.RData, and believes that the response variable 
(Passengers) follows a Poisson distribution. After loading the data into R, the data 
frame data_passenger with all variables (Passengers, route, 
semester, temp) will be available. 
(i) State the linear predictor corresponding to models specified with the following 
R code, explaining all relevant terms: 
(a) temp+semester 
(b) temp*semester 
(c) temp*semester + route 
[6] 
(ii) (a) Fit a Poisson Generalised Linear Model (GLM) to the data set for the 
model in part (i)(c). Label this model as Model1. Your answer should 
include a summary of the fitted model. 
(b) Comment on the significance of the parameters of the model fitted in 
part (ii)(a). 
 [6] 
(iii) (a) Fit an improved model for the model in part (ii)(a), using your answer 
in part (ii)(b). Label this model as Model2. 
(b) Justify why Model2 improves Model1 by referring to the R output. 

You are given a new model (Model3), specified by the following R code: 
Model3 <- glm(Passengers~temp+temp:semester,family=poisson(link="log"))
(iv) (a) Demonstrate that Model3 outperforms the models defined in 
parts (i)(a) and (i)(b). [8] 
(b) Comment on your answer in part (iv)(a). [1]
(v) (a) Draw a suitable plot, for the residuals of Model3, for checking the 
model‚Äôs validity. 
(b) Comment on the plot in part (v)(a). 
 [6] 
(vi) Calculate the predicted number of passengers for an 8 am route during the 
semester at a temperature of 0 degree Celsius, using Model3. 
 [Total 35] 
END OF PAPER 
