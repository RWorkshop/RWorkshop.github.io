<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="RWorkshop.GitHub.io : Website">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>RWorkshop.GitHub.io</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          
          <h1 id="project_title">RWorkshop.GitHub.io</h1>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">\section{The Normal Distribution}

There are four functions that can be used to generate the values associated with the normal distribution.  

The first function we look at it is dnorm. Given a set of values it returns the height of the probability distribution at each point. If you only give the points it assumes you want to use a mean of zero and standard deviation of one. There are options to use different values for the mean and standard deviation, though:

> dnorm(0)
[1] 0.3989423
> dnorm(0)*sqrt(2*pi)
[1] 1
> dnorm(0,mean=4)
[1] 0.0001338302
> dnorm(0,mean=4,sd=10)
[1] 0.03682701
>v <- c(0,1,2)
> dnorm(v)
[1] 0.39894228 0.24197072 0.05399097
> x <- seq(-20,20,by=.1)
> y <- dnorm(x)
> plot(x,y)
> y <- dnorm(x,mean=2.5,sd=0.1)
> plot(x,y)
	
The first function we shall look at is \textbf{\texttt{dnorm}}. Given an appropriate set of argument values (i.e. for mean and standard deviation), this function returns the height of the desnity curve (i.e. plot of the probability density distribution) for those specifications. 

To specify a value for mean, use the argument \textbf{\texttt{mean=}}. Similarly to specify a value for mean, use the argument \textbf{\texttt{sd=}}.

<pre>
<code>
dnorm(3,mean=2,sd=1)
</code>
</pre>
<code>
> dnorm(3,mean=2,sd=1)
[1] 0.2419707
</code>
The default values for mean ($\mu$) and standard deviation ($\sigma$) are 0 and 1 respectively. This is , by definition, the standard normal distribution, commonly called the $Z$ distribution. Therefore, if the values for mean and standard deviation are not specified, 0 and 1 are used by default.
<code>
> dnorm(3)
[1] 0.004431848
> dnorm(0)
[1] 0.3989423
>dnorm(0)*sqrt(2*pi)
[1] 1
> vec = c(0,1,2)
> dnorm(vec)
[1] 0.39894228 0.24197072 0.05399097
</code>
The command <code>dnorm() </code> can be used to plot the bell curve. The bell curve depicted below can be constructed using the following \texttt{R} code.
<pre>
<code>
x = seq(-5,5,by=.01)
y = dnorm(x) 
plot(x,y,type="l",lwd=2,col="red")
abline(h=0)
abline(v=0)
</code>
</pre>
\begin{center}
	\includegraphics[scale=0.30]{dnormCurve}
	% \caption{Some function f(x) evaluated at x=1}
\end{center}

<!--#################################### pnorm #################################################-->
The second function we examine is <code>pnorm() </code>. Given a number or a list this function computes the cumulative distribution function, i.e. probability that a normally distributed random number will be less than that number. This function accepts the same options as <code>dnorm() </code>, i.e. <code>mean=}} and <code>sd=}}.


You can get a full list of them and their options using the help command:

<code>
>  pnorm(0)
[1] 0.5
>  pnorm(1)
[1] 0.8413447
>  pnorm(0,mean=2)
[1] 0.02275013
>
>  pnorm(0,mean=2,sd=3)
[1] 0.2524925
>
>  vec = c(0,1,2)         
>  pnorm(vec)
[1] 0.5000000 0.8413447 0.9772499
>
</code>
	

	
<!--#################################### pnorm #####################################-->
The second function we examine is pnorm. Given a number or a list it computes the probability that a normally distributed random number will be less than that number. This function also goes by the rather ominous title of the “Cumulative Distribution Function.” It accepts the same options as dnorm:

> pnorm(0)
[1] 0.5
> pnorm(1)
[1] 0.8413447
> pnorm(0,mean=2)
[1] 0.02275013
> pnorm(0,mean=2,sd=3)
[1] 0.2524925
> v <- c(0,1,2)
> pnorm(v)
[1] 0.5000000 0.8413447 0.9772499
> x <- seq(-20,20,by=.1)
> y <- pnorm(x)
> plot(x,y)
> y <- pnorm(x,mean=3,sd=4)
> plot(x,y)
If you wish to find the probability that a number is larger than the given number you can use the lower.tail option:

> pnorm(0,lower.tail=FALSE)
[1] 0.5
> pnorm(1,lower.tail=FALSE)
[1] 0.1586553
> pnorm(0,mean=2,lower.tail=FALSE)
[1] 0.9772499
The next function we look at is qnorm which is the inverse of pnorm. The idea behind qnorm is that you give it a probability, and it returns the number whose cumulative distribution matches the probability. For example, if you have a normally distributed random variable with mean zero and standard deviation one, then if you give the function a probability it returns the associated Z-score:

> qnorm(0.5)
[1] 0
> qnorm(0.5,mean=1)
[1] 1
> qnorm(0.5,mean=1,sd=2)
[1] 1
> qnorm(0.5,mean=2,sd=2)
[1] 2
> qnorm(0.5,mean=2,sd=4)
[1] 2
> qnorm(0.25,mean=2,sd=2)
[1] 0.6510205
> qnorm(0.333)
[1] -0.4316442
> qnorm(0.333,sd=3)
[1] -1.294933
> qnorm(0.75,mean=5,sd=2)
[1] 6.34898
> v = c(0.1,0.3,0.75)
> qnorm(v)
[1] -1.2815516 -0.5244005  0.6744898
> x <- seq(0,1,by=.05)
> y <- qnorm(x)
> plot(x,y)
> y <- qnorm(x,mean=3,sd=2)
> plot(x,y)
> y <- qnorm(x,mean=3,sd=0.1)
> plot(x,y)
The last function we examine is the rnorm function which can generate random numbers whose distribution is normal. The argument that you give it is the number of random numbers that you want, and it has optional arguments to specify the mean and standard deviation:

> rnorm(4)
[1]  1.2387271 -0.2323259 -1.2003081 -1.6718483
> rnorm(4,mean=3)
[1] 2.633080 3.617486 2.038861 2.601933
> rnorm(4,mean=3,sd=3)
[1] 4.580556 2.974903 4.756097 6.395894
> rnorm(4,mean=3,sd=3)
[1]  3.000852  3.714180 10.032021  3.295667
> y <- rnorm(200)
> hist(y)
> y <- rnorm(200,mean=-2)
> hist(y)
> y <- rnorm(200,mean=-2,sd=4)
> hist(y)
> qqnorm(y)
> qqline(y)
<!--####################################################################################-->
\subsection{Applications of the Normal Distribution}
Suppose the mass of shire horses is assumed to have a normal distribution with mean 1000kg and standard deviation 50kg. 
<ol>
<li> Calculate the probability that the mass of a shire horse is less than 975kgs.
<li> Calculate the probability that the mass of a shire horse is more than 975kgs.
<li> Calculate the probability that the mass of a shire horse is between 940kg and 1030kg.         
<li> Calculate the probability that the mass of a shire horse exceeds 1030kg.                
<\ol>

Solutions: Let X be the mass of the horses, distributed as
\[ X \sim \mathcal{N}(1000,50^2)\].
<ol>
<li> $P(X \leq 975)$ : <code>pnorm(975,mean=1000,sd=50)}}.
<li> $P(X \geq 975)$ =  $ 1- P(X \leq 975)$:<code>1-pnorm(975,mean=1000,sd=50)}}. 
<li> $P(940 \leq X \leq 1030)$ = $P(X \leq 1030) -  P(X \leq 940)$  : <code>pnorm(1030,mean=1000,sd=50)}} - <code>pnorm(940,mean=1000,sd=50)}}.     
<li> $P(X \geq 1030)$       <code>pnorm(1030,mean=1000,sd=50,lower=FALSE)}}.
<\ol>
<code>
> pnorm(975,mean=1000,sd=50)
[1] 0.3085375
> 1-pnorm(975,mean=1000,sd=50)
[1] 0.6914625
> pnorm(1030,mean=1000,sd=50)-pnorm(940,mean=1000,sd=50)
[1] 0.6106772
>
> pnorm(1030,mean=1000,sd=50)
[1] 0.7257469
> pnorm(1030,mean=1000,sd=50,lower=FALSE)
[1] 0.2742531



</code>
The answers are $30.85\%,69.14\%$ and $61.06\%$ respectively.
<hr>
The next function we look at is <code>qnorm() </code>, which is the inverse of <code>pnorm() </code>. The idea behind <code>qnorm() </code> is that you specify the probability, and it returns the number whose cumulative distribution matches the probability. 
For example, if you have a normally distributed random variable with mean zero and standard deviation one, then if you give the function a probability it returns the associated Z-value:


<code>
> qnorm(0.5)
[1] 0
>#Well Known Z Scores
> qnorm(0.95)
[1] 1.644854
> qnorm(0.975)
[1] 1.959964
> qnorm(0.995)
[1] 2.575829
>
> qnorm(0.5,mean=1)
[1] 1
>  qnorm(0.5,mean=1,sd=2)
[1] 1
>  qnorm(0.5,mean=2,sd=2)
[1] 2
>  qnorm(0.5,mean=2,sd=4)
[1] 2
>  qnorm(0.25,mean=2,sd=2)
[1] 0.6510205
> 
</code>

The last function we examine is the  \textbf{\texttt{help(rnorm)}} function which can generate normally distributed random numbers. The argument that must be specified are the number of random numbers required, as well as optional arguments to specify the mean and standard deviation. Randomly generated numbers will be specified to several decimal places, so it is worth recalling functions such as \textbf{\texttt{help(round())}} that can be used to manage precision.
<code>
>  rnorm(4)
[1] -0.79949714 -1.14181543  0.09373155 -0.18318997
>
>  rnorm(4,mean=3)
[1] 3.948279 4.214592 1.488769 1.354725
>
>  rnorm(4,mean=3,sd=3)
[1] 1.259427 1.554388 1.654530 1.076075
> 
>  rnorm(4,mean=3,sd=3)
[1] 2.802254 2.681757 1.528246 6.496170
> 
</code>

The help file for thes commands can be obtained by specifying any one of the fuctions as an argument to the \textbf{\texttt{help() </code> function: e.g.\textbf{\texttt{help(dnorm)}}.
<br>
